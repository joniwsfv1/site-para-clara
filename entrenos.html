<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Entre NÃ³s â€” Joni & Clara</title>

<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body {
  margin: 0;
  background: #000;
  color: #fff;
  font-family: 'Patrick Hand', cursive;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.container {
  max-width: 420px;
  width: 100%;
  padding: 20px;
  text-align: center;
  animation: fadeIn 0.8s ease;
}

h1 {
  font-size: 2.3em;
}

#status {
  opacity: 0.8;
}

.question {
  font-size: 1.5em;
  margin: 25px 0;
  animation: slideUp 0.5s ease;
}

button {
  width: 100%;
  padding: 15px;
  margin: 10px 0;
  font-size: 1.2em;
  border: none;
  border-radius: 14px;
  cursor: pointer;
  background: #fff;
  color: #000;
  transition: transform 0.2s, background 0.2s;
}

button:hover {
  transform: scale(1.03);
  background: #ffd6e7;
}

button:disabled {
  opacity: 0.5;
}

.result {
  margin-top: 20px;
  font-size: 1.4em;
  animation: fadeIn 0.6s ease;
}

.polaroid {
  background: #fff;
  padding: 10px 10px 25px;
  border-radius: 6px;
  margin: 20px auto;
  width: 220px;
  transform: rotate(-2deg);
  box-shadow: 0 10px 30px rgba(0,0,0,0.6);
}

.polaroid img {
  width: 100%;
  border-radius: 4px;
}

@keyframes fadeIn {
  from { opacity: 0 }
  to { opacity: 1 }
}

@keyframes slideUp {
  from { transform: translateY(10px); opacity: 0 }
  to { transform: translateY(0); opacity: 1 }
}
</style>
</head>

<body>

<div class="container">
  <h1>ğŸ’– Entre NÃ³s</h1>
  <div id="status">Aguardando o outro jogadorâ€¦</div>

  <div class="question" id="question"></div>

  <button id="btn1" onclick="choose(0)"></button>
  <button id="btn2" onclick="choose(1)"></button>

  <div class="result" id="result"></div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBrv-pX5Kz0anUKkAFwj-di_2xGc-Hkg4c",
  authDomain: "joni-e-clara.firebaseapp.com",
  databaseURL: "https://joni-e-clara-default-rtdb.firebaseio.com",
  projectId: "joni-e-clara",
  storageBucket: "joni-e-clara.appspot.com",
  messagingSenderId: "173695416195",
  appId: "1:173695416195:web:fc7c7dd41dad40e3e028b6"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const room = location.hash.replace("#","") || "joni-e-clara";
location.hash = room;

const playerId = Math.random().toString(36).substr(2, 9);
const roomRef = db.ref("rooms/" + room);

const questions = [
  { q: "Um sÃ¡bado perfeito Ã©...", a: ["Ficar em casa juntos", "Sair sem rumo"] },
  { q: "Filme ideal?", a: ["Romance", "Terror"] },
  { q: "Quem sente mais saudade?", a: ["Joni", "Clara"] },
  { q: "Viagem dos sonhos?", a: ["Praia", "Montanha"] },
  { q: "Mais ciumento?", a: ["Joni", "Clara"] }
];

let current = 0;
let answered = false;
let score = 0;

function loadQuestion() {
  answered = false;
  document.getElementById("question").innerText = questions[current].q;
  document.getElementById("btn1").innerText = questions[current].a[0];
  document.getElementById("btn2").innerText = questions[current].a[1];
  document.getElementById("result").innerText = "";
}

roomRef.child("answers").on("value", snap => {
  const all = snap.val();
  if (!all || !all[current]) return;

  const answers = Object.values(all[current]);
  if (answers.length < 2) {
    document.getElementById("status").innerText = "Aguardando o outro jogadorâ€¦";
    return;
  }

  document.getElementById("status").innerText = "ğŸ’ Os dois responderam!";

  if (answers[0] === answers[1]) {
    score++;
    document.getElementById("result").innerText = "ğŸ’– VocÃªs pensaram igual!";
  } else {
    document.getElementById("result").innerText = "ğŸ˜… Diferentes, mas combinam!";
  }

  setTimeout(nextQuestion, 2000);
});

function choose(option) {
  if (answered) return;
  answered = true;

  roomRef.child(`answers/${current}/${playerId}`).set(option);
}

function nextQuestion() {
  roomRef.child(`answers/${current}`).remove();
  current++;

  if (current >= questions.length) {
    showResult();
  } else {
    loadQuestion();
  }
}

function showResult() {
  const percent = Math.round((score / questions.length) * 100);

  document.getElementById("question").innerText = "Resultado Final ğŸ’˜";
  document.getElementById("btn1").style.display = "none";
  document.getElementById("btn2").style.display = "none";

  document.getElementById("result").innerHTML = `
    <div class="polaroid">
      <img src="foto-nos.jpg" alt="NÃ³s dois">
    </div>

    VocÃªs combinaram em <b>${percent}%</b> ğŸ’•<br><br>
    ${percent >= 80 ? "Almas gÃªmeas ğŸ¥°" :
      percent >= 50 ? "Casal forte ğŸ’" :
      "Opostos que se atraem ğŸ˜"}

    <br><br>
    <button onclick="restart()">ğŸ” Jogar de novo</button>
  `;
}

function restart() {
  roomRef.remove();
  location.reload();
}

loadQuestion();
</script>

</body>
</html>
